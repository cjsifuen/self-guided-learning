<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A resource for self-guided learning - Bash Scripting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../0-The-Unix-Shell/variables-and-loops.html" rel="prev">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DQ7RX0NWYQ"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DQ7RX0NWYQ', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">A resource for self-guided learning</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../getting-started.html">
 <span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../software-installs.html">
 <span class="menu-text">Software Installs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../learning-resources.html">
 <span class="menu-text">Learning Resource List</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../domain-specific-series.html">
 <span class="menu-text">Domain-Specific Series</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Bash Scripting</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">The Unix Shell</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/series-introduction.html" class="sidebar-item-text sidebar-link">Series Introduction</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/installation.html" class="sidebar-item-text sidebar-link">Installation and Resources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/introducing-the-shell.html" class="sidebar-item-text sidebar-link">Introducing the Shell</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/the-file-system.html" class="sidebar-item-text sidebar-link">The File System</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/patterns-filters-and-pipes.html" class="sidebar-item-text sidebar-link">Patterns, Filters, and Pipes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/variables-and-loops.html" class="sidebar-item-text sidebar-link">Variables and Loops</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../0-The-Unix-Shell/bash-scripting.html" class="sidebar-item-text sidebar-link active">Bash Scripting</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#scripts" id="toc-scripts" class="nav-link active" data-scroll-target="#scripts">Scripts</a>
  <ul>
  <li><a href="#starting-a-script" id="toc-starting-a-script" class="nav-link" data-scroll-target="#starting-a-script">Starting a Script</a></li>
  <li><a href="#using-a-script" id="toc-using-a-script" class="nav-link" data-scroll-target="#using-a-script">Using a Script</a></li>
  </ul></li>
  <li><a href="#putting-this-into-practice-processig-rna-seq-data" id="toc-putting-this-into-practice-processig-rna-seq-data" class="nav-link" data-scroll-target="#putting-this-into-practice-processig-rna-seq-data">Putting this into practice – Processig RNA-seq Data</a>
  <ul>
  <li><a href="#rna-sequencing" id="toc-rna-sequencing" class="nav-link" data-scroll-target="#rna-sequencing">RNA-sequencing</a></li>
  <li><a href="#general-analysis-steps" id="toc-general-analysis-steps" class="nav-link" data-scroll-target="#general-analysis-steps">General Analysis Steps</a></li>
  <li><a href="#toolssoftware" id="toc-toolssoftware" class="nav-link" data-scroll-target="#toolssoftware">Tools/Software</a></li>
  <li><a href="#sample-datasets" id="toc-sample-datasets" class="nav-link" data-scroll-target="#sample-datasets">Sample Datasets</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul>
  <li><a href="#initial-read-qc" id="toc-initial-read-qc" class="nav-link" data-scroll-target="#initial-read-qc">Initial Read QC</a></li>
  <li><a href="#read-qc-trimming" id="toc-read-qc-trimming" class="nav-link" data-scroll-target="#read-qc-trimming">Read QC Trimming</a></li>
  <li><a href="#aligning-reads" id="toc-aligning-reads" class="nav-link" data-scroll-target="#aligning-reads">Aligning Reads</a></li>
  <li><a href="#quantifying-expression" id="toc-quantifying-expression" class="nav-link" data-scroll-target="#quantifying-expression">Quantifying Expression</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Bash Scripting</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="scripts" class="level3">
<h3 class="anchored" data-anchor-id="scripts">Scripts</h3>
<p>Scripts are files that hold a series of commands that are to be interpreted and executed.</p>
<section id="starting-a-script" class="level4">
<h4 class="anchored" data-anchor-id="starting-a-script">Starting a Script</h4>
<p>Because scripts can be written in any language, the computer needs to know which interpreter to use to interpret the commands. The hashbang, <code>#!</code> (or shebang), followed by the location, tells the computer where to find the interpreter for the specific language that is being used.</p>
<p>These are usually found in specific locations, but can vary slightly. The options below are worth trying.</p>
<ul>
<li><code>#!/bin/bash</code></li>
<li><code>#!/usr/bin/env bash</code></li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The hashbang/shebang must the be first line of the script – otherwise the <code>#</code> will be seen as a commenting line.</p>
</div>
</div>
</section>
<section id="using-a-script" class="level4">
<h4 class="anchored" data-anchor-id="using-a-script">Using a Script</h4>
<p>Using any script is similar to running the commands we’ve learned.</p>
<ul>
<li><code>bash script.sh</code></li>
<li><code>./script.sh</code> – need to have permissions to run it this way</li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>While we won’t cover this today, we can create scripts that specify flags and take inputs as parameters/arguments to be used as variable values in the script.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="putting-this-into-practice-processig-rna-seq-data" class="level3">
<h3 class="anchored" data-anchor-id="putting-this-into-practice-processig-rna-seq-data">Putting this into practice – Processig RNA-seq Data</h3>
<p>Let’s put this into action with an example RNA-seq workflow.</p>
<section id="rna-sequencing" class="level4">
<h4 class="anchored" data-anchor-id="rna-sequencing">RNA-sequencing</h4>
<p>RNA-sequencing (RNA-seq) is a method that allows for the sequencing of complex mixtures of RNA. Different analyses can be peformed with these data, including assessing</p>
<ul>
<li>gene expression (changes over time, or differences between groups/treatments)</li>
<li>transcript splicing</li>
<li>post-transcriptional modifications</li>
<li>gene fusions</li>
<li>and more</li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a good introduction to RNA-seq analysis, visit <a href="https://rnaseq.uoregon.edu/">RNA-seqlopedia</a></p>
</div>
</div>
<hr>
</section>
<section id="general-analysis-steps" class="level4">
<h4 class="anchored" data-anchor-id="general-analysis-steps">General Analysis Steps</h4>
<p>While there are variations to RNA-seq analyses, generally, the following steps are performed</p>
<ol type="1">
<li>Demultiplex reads</li>
<li>Initial read quality check</li>
<li>Filter and trim sequencing reads</li>
<li>Normalize sequencing reads</li>
<li><em>De novo</em> assembly of transcripts (if a reference genome is not available)</li>
<li>Map (align) sequencing reads to reference genome or transcriptome</li>
<li>Annotate transcripts assembled or to which reads have been mapped</li>
<li>Count mapped reads to estimate transcript abundance</li>
<li>Perform statistical analysis to identify differential expression (or differential splicing) among samples or treatments</li>
<li>Perform multivariate statistical analysis/visualization to assess transcriptome-wide differences among samples</li>
</ol>
<hr>
</section>
<section id="toolssoftware" class="level4">
<h4 class="anchored" data-anchor-id="toolssoftware">Tools/Software</h4>
<p>There are MANY tools that can be used at each of these steps, each with their own pros and cons. For this lesson, we will use the following, stopping after quantification:</p>
<table class="table">
<colgroup>
<col style="width: 42%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Tool</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Demultiplex</td>
<td>Performed already (usually using <code>bcl2fastq</code>)</td>
</tr>
<tr class="even">
<td>Initial read QC</td>
<td><code>FastQC</code></td>
</tr>
<tr class="odd">
<td>Filter and trim reads</td>
<td><code>TrimGalore!</code></td>
</tr>
<tr class="even">
<td>Alignment</td>
<td><code>STAR</code></td>
</tr>
<tr class="odd">
<td>Abundance quantification</td>
<td><code>Subread</code></td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="sample-datasets" class="level4">
<h4 class="anchored" data-anchor-id="sample-datasets">Sample Datasets</h4>
<p>Our dataset here sequencing data files (<code>fastq</code> files) from 6 samples, that are divided into 2 groups (1 and 2).</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Sample Name</th>
<th>Group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sample_01</td>
<td>1</td>
</tr>
<tr class="even">
<td>sample_02</td>
<td>1</td>
</tr>
<tr class="odd">
<td>sample_03</td>
<td>1</td>
</tr>
<tr class="even">
<td>sample_04</td>
<td>2</td>
</tr>
<tr class="odd">
<td>sample_05</td>
<td>2</td>
</tr>
<tr class="even">
<td>sample_06</td>
<td>2</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<p>We’ll implement this analysis using bash scripts.</p>
<p>I will walk through the initial step here, then we will work more hands-on in each step, building the scripts together.</p>
<section id="initial-read-qc" class="level4">
<h4 class="anchored" data-anchor-id="initial-read-qc">Initial Read QC</h4>
<p>One of the first steps will be to check the quality of the sequencing reads with <code>FastQC</code>. The options we will be using are shown below.</p>
<table class="table">
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-o</code></td>
<td>output directory</td>
</tr>
<tr class="even">
<td><code>-noextract</code></td>
<td>do not unzip (extract) the final output</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>the format of the input file is <code>fastq</code></td>
</tr>
<tr class="even">
<td><code>-t</code></td>
<td>use this number of threads for processing</td>
</tr>
<tr class="odd">
<td><code>[input files]</code></td>
<td>input file(s)</td>
</tr>
</tbody>
</table>
<p>The following is how this command could be run at the command line for <code>sample_01</code>.</p>
<p><em>Note: The <code>\</code> at the end of the line allows me to break up the command onto different lines, but the command in still interpreted as a single command.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="nil"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="dt">\</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a> <span class="at">-o</span> ~/Desktop/rnaseq <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> <span class="at">--noextract</span> <span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> <span class="at">-f</span> fastq <span class="dt">\</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> <span class="at">-t</span> 4 <span class="dt">\</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a> sample_01_1.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How would we put this into a bash script?</p>
<ul>
<li>put the command in a plain text file, saved with a suffix <code>.sh</code></li>
<li>specify the interpreter with the hashbang</li>
<li>add in the code</li>
<li>generalize if possibe, with variables, etc.</li>
</ul>
<p>Try to create a bash script for this first step.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<em>Click here for an answer</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the example below we</p>
<ul>
<li>set the interpreter</li>
<li>set variables for the fastq directory location and the output qc directory location</li>
<li>make the output directory location</li>
<li>perform the anlaysis in a loop</li>
</ul>
<p>If we named this <code>fastqc.sh</code> we could run this by typing <code>bash fastqc.sh</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="nil"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set variables</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="va">FQ_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/simulated_reads/fastq/'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="va">QC_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/QC/'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#make output directory</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">${QC_DIR}</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#fastqc on each file</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fq <span class="kw">in</span> <span class="va">${FQ_DIR}</span><span class="pp">*</span>.fastq<span class="kw">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="ex">fastqc</span> <span class="dt">\</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span> <span class="va">${QC_DIR}</span> <span class="dt">\</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">--noextract</span> <span class="dt">\</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">-f</span> fastq <span class="dt">\</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">-t</span> 4 <span class="dt">\</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">${fq}</span><span class="kw">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="read-qc-trimming" class="level4">
<h4 class="anchored" data-anchor-id="read-qc-trimming">Read QC Trimming</h4>
<p>A common next step, should the <code>FastQC</code> analysis show a high-level of adapter content, or poor quality sequencing, would be to perform adapter trimming and read filtering or quality trimming. We’re going to pretend we need to trim and will be using <code>TrimGalore!</code>.</p>
<table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-q</code></td>
<td>quality value threshold for base calls, cuts bases with score below value</td>
</tr>
<tr class="even">
<td><code>--length</code></td>
<td>remove reads that become shorter than this length</td>
</tr>
<tr class="odd">
<td><code>--basename</code></td>
<td>the basename of the sample/file</td>
</tr>
<tr class="even">
<td><code>-o</code></td>
<td>output directory</td>
</tr>
<tr class="odd">
<td><code>--paired</code></td>
<td>if paired-end reads, the paired read files</td>
</tr>
</tbody>
</table>
<p>How would we put this into a bash script?</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<em>Click here for an answer</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the example below we</p>
<ul>
<li>set the interpreter</li>
<li>set variables</li>
<li>make the output directory location</li>
<li>perform the anlaysis in a loop, while grabbing the basename of each file using the <code>basename</code> command.</li>
</ul>
<p>If we named this <code>trim.sh</code> we could run this by typing <code>bash trim.sh</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="nil"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set variables</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="va">FQ_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/simulated_reads/fastq/'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="va">QC_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/QC/'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="va">TRIM_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/TRIM/'</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#make output directory</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">${TRIM_DIR}</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#trimgalore! on each file</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fq <span class="kw">in</span> <span class="va">${FQ_DIR}</span><span class="pp">*</span>_1.fastq<span class="kw">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">${fq}</span> <span class="st">'_1.fastq'</span><span class="va">)</span><span class="kw">;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">trim_galore</span> <span class="dt">\</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">-q</span> 30 <span class="dt">\</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">--length</span> 20 <span class="dt">\</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--basename</span> <span class="va">${BASE}</span> <span class="dt">\</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span> <span class="va">${TRIM_DIR}</span> <span class="dt">\</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--paired</span> <span class="va">${FQ_DIR}${BASE}</span>_1.fastq <span class="va">${FQ_DIR}${BASE}</span>_2.fastq<span class="kw">;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="aligning-reads" class="level4">
<h4 class="anchored" data-anchor-id="aligning-reads">Aligning Reads</h4>
<p>The next step is to align filtered reads. We will use <code>STAR</code> for this, with the following options.</p>
<p><em>Note: The trimming tool will output a specific file format of the sample name, followed by <code>_val_</code>, then the read, then end in <code>.fq</code>. This must be taken into account for the next step.</em></p>
<table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-genomeDir</code></td>
<td>path to the genome directory, with the index files</td>
</tr>
<tr class="even">
<td><code>--readFilesIn</code></td>
<td>the path to the reads files</td>
</tr>
<tr class="odd">
<td><code>--sjdbGTFfile</code></td>
<td>the path to the GTF file associated with the genome file</td>
</tr>
<tr class="even">
<td><code>-outFileNamePrefix</code></td>
<td>output prefix, with directory in front</td>
</tr>
<tr class="odd">
<td><code>--runThreadN</code></td>
<td>number of threads to use, if possible</td>
</tr>
<tr class="even">
<td><code>--outSAMattributes</code></td>
<td>alignment attributes to report</td>
</tr>
<tr class="odd">
<td><code>--outSAMtype</code></td>
<td>the format to output (SAM/BAM, etc) and whether to sort</td>
</tr>
</tbody>
</table>
<p>How would we put this into a bash script?</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<em>Click here for an answer</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the example below we</p>
<ul>
<li>set the interpreter</li>
<li>set variables</li>
<li>make the output directory location</li>
<li>perform the anlaysis in a loop, while grabbing the basename of each file using the <code>basename</code> command.</li>
</ul>
<p>If we named this <code>star.sh</code> we could run this by typing <code>bash star.sh</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="nil"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set variables</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">FQ_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/simulated_reads/fastq/'</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="va">QC_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/QC/'</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="va">TRIM_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/TRIM/'</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="va">GENOME_FASTA</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/index/'</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="va">GENOME_GTF</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/index/Homo_sapiens.GRCh38.103.gtf'</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="va">ALN_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/ALIGN/'</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#make output directory</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">${ALN_DIR}</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#star alignment on each file</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">${TRIM_DIR}</span><span class="pp">*</span>_val_1.fq<span class="kw">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="va">BASE</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">${i}</span> <span class="st">'_val_1.fq'</span><span class="va">)</span><span class="kw">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">${BASE}</span><span class="kw">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">STAR</span> <span class="dt">\</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">--genomeDir</span> <span class="va">${GENOME_FASTA}</span> <span class="dt">\</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">--readFilesIn</span> <span class="va">${TRIM_DIR}${BASE}</span>_val_1.fq <span class="va">${TRIM_DIR}${BASE}</span>_val_2.fq <span class="dt">\</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">--sjdbGTFfile</span> <span class="va">${GENOME_GTF}</span> <span class="dt">\</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">--outFileNamePrefix</span> <span class="va">${ALN_DIR}${BASE}</span> <span class="dt">\</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">--runThreadN</span> 4 <span class="dt">\</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">--outSAMattributes</span> Standard <span class="dt">\</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">--outSAMtype</span> BAM SortedByCoordinate <span class="dt">\</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">--outFilterMismatchNmax</span> 999 <span class="dt">\</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alignSJoverhangMin</span> 8 <span class="dt">\</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alignSJDBoverhangMin</span> 1 <span class="dt">\</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">--outFilterMismatchNoverReadLmax</span> 0.04 <span class="dt">\</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alignIntronMin</span> 20 <span class="dt">\</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alignIntronMax</span> 1000000 <span class="dt">\</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">--alignMatesGapMax</span> 1000000 <span class="dt">\</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">--sjdbScore</span> 1<span class="kw">;</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="quantifying-expression" class="level4">
<h4 class="anchored" data-anchor-id="quantifying-expression">Quantifying Expression</h4>
<p>In the next step, we use <code>featureCounts</code> from <code>Subread</code> to quantify the expression of genes.</p>
<table class="table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-O</code></td>
<td>assign reads to their overlapping features</td>
</tr>
<tr class="even">
<td><code>-p</code></td>
<td>count as fragments, with paired end reads</td>
</tr>
<tr class="odd">
<td><code>-B</code></td>
<td>count only reads where both pairs align</td>
</tr>
<tr class="even">
<td><code>-C</code></td>
<td>do not count if reads map to different chromosomes or different strands</td>
</tr>
<tr class="odd">
<td><code>-T</code></td>
<td>threads to use</td>
</tr>
<tr class="even">
<td><code>-s</code></td>
<td>strand-specific read counting</td>
</tr>
<tr class="odd">
<td><code>-a</code></td>
<td>annotation file (GTF, etc.)</td>
</tr>
<tr class="even">
<td><code>-o</code></td>
<td>output file name</td>
</tr>
<tr class="odd">
<td><code>[file]</code></td>
<td>the format to output (SAM/BAM, etc) and whether to sort</td>
</tr>
</tbody>
</table>
<p>How would we put this into a bash script?</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<em>Click here for an answer</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the example below we</p>
<ul>
<li>set the interpreter</li>
<li>set variables</li>
<li>make the output directory location</li>
<li>perform the anlaysis in a loop</li>
<li>clean the files, remove <code>#</code> and cutting specific columns</li>
</ul>
<p>If we named this <code>count.sh</code> we could run this by typing <code>bash count.sh</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="nil"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set variables</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="va">GENOME_GTF</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/index/Homo_sapiens.GRCh38.103.gtf'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="va">ALN_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/ALIGN/'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="va">STRAND</span><span class="op">=</span><span class="st">'0'</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="va">COUNTS_DIR</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/COUNTS/'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="va">ANNOT_TMP</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/COUNTS/counts.tmp'</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="va">ANNOT_OUT</span><span class="op">=</span><span class="st">'/Users/csifuentes/Desktop/shell-lesson-data/rnaseq/COUNTS/counts.txt'</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#make output directory</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">${COUNTS_DIR}</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#featureCounts on all files together</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="ex">featureCounts</span> <span class="dt">\</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">-O</span> <span class="dt">\</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">-p</span> <span class="dt">\</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">-B</span> <span class="dt">\</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">-C</span> <span class="dt">\</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">-T</span> 4 <span class="dt">\</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">-s</span> <span class="va">${STRAND}</span> <span class="dt">\</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-a</span> <span class="va">${GENOME_GTF}</span> <span class="dt">\</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span> <span class="va">${ANNOT_TMP}</span> <span class="dt">\</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">${ALN_DIR}</span><span class="pp">*</span>Aligned.sortedByCoord.out.bam</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#clean file</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="st">'/^#/d'</span> <span class="va">${ANNOT_TMP}</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-f</span> 1,7- <span class="op">&gt;</span> <span class="va">${ANNOT_OUT}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
<p>These scripts used here, can be improved upon, by combining them, generalizing more, adding in extra sanity checks, and taking input from the commandline, etc.</p>
<p>I encourage you to explore more, build and use these skills.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../0-The-Unix-Shell/variables-and-loops.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variables and Loops</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>